# SolidityGuard Vulnerability Patterns Database

## 104 Patterns (ETH-001 to ETH-104)

### Reentrancy (ETH-001 to ETH-005)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-001 | Single-function Reentrancy | CRITICAL | SWC-107 | State update after `.call{}`/`.transfer()` |
| ETH-002 | Cross-function Reentrancy | CRITICAL | SWC-107 | Shared state across functions with external calls |
| ETH-003 | Cross-contract Reentrancy | HIGH | SWC-107 | External contract reads stale state during call |
| ETH-004 | Read-only Reentrancy | HIGH | — | View functions return incorrect values during call |
| ETH-005 | Cross-chain Reentrancy | HIGH | — | Bridge callback exploits pending state |

### Access Control (ETH-006 to ETH-012)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-006 | Missing Access Control | CRITICAL | SWC-105 | State-changing function without modifier |
| ETH-007 | tx.origin Authentication | CRITICAL | SWC-115 | `tx.origin` in require/if |
| ETH-008 | Unprotected selfdestruct | CRITICAL | SWC-106 | `selfdestruct` without access check |
| ETH-009 | Default Function Visibility | HIGH | SWC-100 | Missing visibility specifier |
| ETH-010 | Uninitialized Proxy | CRITICAL | — | Implementation without initializer |
| ETH-011 | Missing Modifier | HIGH | — | State change without `onlyOwner`/`onlyRole` |
| ETH-012 | Centralization Risk | MEDIUM | — | Single admin, no timelock/multisig |

### Arithmetic (ETH-013 to ETH-017)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-013 | Integer Overflow/Underflow | HIGH | SWC-101 | Pre-0.8 or `unchecked` arithmetic |
| ETH-014 | Division Before Multiplication | MEDIUM | — | `a / b * c` pattern |
| ETH-015 | Unchecked Math | HIGH | — | `unchecked {}` with user input |
| ETH-016 | Rounding Errors | MEDIUM | — | `round()` in financial math |
| ETH-017 | Precision Loss | MEDIUM | — | Token decimal mishandling |

### External Calls (ETH-018 to ETH-023)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-018 | Unchecked Return | HIGH | SWC-104 | `.call()` without success check |
| ETH-019 | Delegatecall Untrusted | CRITICAL | SWC-112 | `delegatecall` with user input |
| ETH-020 | Unsafe Low-level Call | HIGH | — | Raw `.call()` instead of interface |
| ETH-021 | DoS with Failed Call | HIGH | SWC-113 | Loop with external calls |
| ETH-022 | Return Value Not Checked | HIGH | — | `IERC20.transfer()` without SafeERC20 |
| ETH-023 | Gas Griefing | MEDIUM | SWC-126 | Forwarded gas insufficient |

### Oracle & Price (ETH-024 to ETH-028)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-024 | Oracle Manipulation | CRITICAL | — | Single spot price, no TWAP |
| ETH-025 | Flash Loan Attack | CRITICAL | — | No same-block protection |
| ETH-026 | Sandwich Attack | HIGH | — | No min output / slippage |
| ETH-027 | Missing Slippage | HIGH | — | No `minAmountOut` parameter |
| ETH-028 | Stale Oracle | HIGH | — | No `updatedAt` validation |

### Storage (ETH-029 to ETH-033)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-029 | Uninitialized Storage | HIGH | SWC-109 | Local struct without init |
| ETH-030 | Storage Collision | CRITICAL | SWC-124 | Proxy storage mismatch |
| ETH-031 | Shadowing State | MEDIUM | SWC-119 | Same name in parent/child |
| ETH-032 | Unexpected ETH | MEDIUM | SWC-132 | `address(this).balance ==` |
| ETH-033 | Arbitrary Storage Write | CRITICAL | SWC-124 | User-controlled storage slot |

### Logic (ETH-034 to ETH-040)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-034 | Strict Equality | HIGH | SWC-132 | `== 0` on balance |
| ETH-035 | TX Order Dependence | HIGH | SWC-114 | Outcome depends on tx order |
| ETH-036 | Timestamp Dependence | MEDIUM | SWC-116 | `block.timestamp` in logic |
| ETH-037 | Weak Randomness | HIGH | SWC-120 | `blockhash`/`block.timestamp` for random |
| ETH-038 | Signature Malleability | HIGH | SWC-117 | ECDSA without s-value check |
| ETH-039 | Signature Replay | CRITICAL | SWC-121 | Missing nonce/chainId |
| ETH-040 | Front-running | HIGH | SWC-114 | Predictable profitable action |

### Token (ETH-041 to ETH-048)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-041 | Non-standard Return | HIGH | — | IERC20 without SafeERC20 |
| ETH-042 | Fee-on-Transfer | HIGH | — | Balance not checked after transfer |
| ETH-043 | Rebasing Token | HIGH | — | Cached balance becomes stale |
| ETH-044 | ERC-777 Hook | CRITICAL | — | Token callback reentrancy |
| ETH-045 | Zero Address | MEDIUM | — | Missing `address(0)` check |
| ETH-046 | Approval Race | MEDIUM | — | approve() without reset |
| ETH-047 | Infinite Approval | LOW | — | `type(uint256).max` approval |
| ETH-048 | Supply Manipulation | HIGH | — | Unrestricted mint/burn |

### Proxy (ETH-049 to ETH-054)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-049 | Uninitialized Impl | CRITICAL | — | No `_disableInitializers()` |
| ETH-050 | Storage Mismatch | CRITICAL | — | Variable reorder on upgrade |
| ETH-051 | Selector Clash | HIGH | — | Function hash collision |
| ETH-052 | Missing Upgrade Auth | CRITICAL | — | `upgradeTo` without access control |
| ETH-053 | selfdestruct in Impl | HIGH | — | Implementation can self-destruct |
| ETH-054 | Transparent Collision | HIGH | — | Admin/user selector overlap |

### DeFi (ETH-055 to ETH-065)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-055 | Governance Manipulation | HIGH | — | Flash loan voting |
| ETH-056 | Liquidation Manipulation | HIGH | — | Oracle-based unfair liquidation |
| ETH-057 | Vault Inflation | CRITICAL | — | First depositor share attack |
| ETH-058 | Donation Attack | HIGH | — | Direct token transfer manipulation |
| ETH-059 | AMM Error | CRITICAL | — | Constant product formula bug |
| ETH-060 | Missing Deadline | MEDIUM | — | No `block.timestamp` check |
| ETH-061 | Flash Mint | HIGH | — | Unrestricted flash minting |
| ETH-062 | Pool Imbalance | HIGH | — | Unbalanced deposit manipulation |
| ETH-063 | Reward Error | HIGH | — | Reward calculation bug |
| ETH-064 | Insecure Callback | HIGH | — | Callback handler exploitable |
| ETH-065 | Cross-protocol Risk | MEDIUM | — | External protocol dependency |

### Gas & DoS (ETH-066 to ETH-070)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-066 | Unbounded Loop | HIGH | SWC-128 | Loop over dynamic array |
| ETH-067 | Block Gas Limit | HIGH | SWC-128 | Operation may exceed block gas |
| ETH-068 | Unexpected Revert | MEDIUM | SWC-113 | Revert in loop blocks all |
| ETH-069 | Griefing | MEDIUM | — | Attacker can make ops expensive |
| ETH-070 | Storage Exhaustion | LOW | — | Unlimited storage growth |

### Miscellaneous (ETH-071 to ETH-080)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-071 | Floating Pragma | LOW | SWC-103 | `pragma solidity ^` or `>=` |
| ETH-072 | Outdated Compiler | LOW | SWC-102 | Old Solidity version |
| ETH-073 | Hash Collision | MEDIUM | SWC-133 | `abi.encodePacked` dynamic types |
| ETH-074 | RTL Override | HIGH | SWC-130 | U+202E character in source |
| ETH-075 | No Effects | LOW | SWC-135 | Code that does nothing |
| ETH-076 | Missing Events | LOW | — | State change without event |
| ETH-077 | Inheritance Order | MEDIUM | SWC-125 | C3 linearization issue |
| ETH-078 | Private Data | LOW | SWC-136 | Sensitive data on-chain |
| ETH-079 | Hardcoded Gas | LOW | SWC-134 | `transfer()` 2300 gas limit |
| ETH-080 | Wrong Constructor | HIGH | SWC-118 | Function name as constructor |

### Transient Storage — EIP-1153 (ETH-081 to ETH-085)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-081 | Transient Storage Slot Collision | CRITICAL | — | Multiple contracts use same TSTORE slot via delegatecall |
| ETH-082 | Transient Storage Not Cleared | HIGH | — | `tstore` without matching end-of-tx cleanup assumption violated |
| ETH-083 | TSTORE Reentrancy Bypass | CRITICAL | — | Reentrancy lock via TSTORE bypassed by low-gas external call |
| ETH-084 | Transient Storage Delegatecall Exposure | HIGH | — | `delegatecall` exposes caller's transient storage to callee |
| ETH-085 | Transient Storage Type-Safety Bypass | MEDIUM | — | TLOAD returns raw bytes, cast to wrong type |

### EIP-7702 / Pectra (ETH-086 to ETH-089)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-086 | Broken tx.origin == msg.sender Assumption | CRITICAL | — | `tx.origin == msg.sender` no longer guarantees EOA under EIP-7702 |
| ETH-087 | Malicious EIP-7702 Delegation | HIGH | — | EOA delegates to malicious code, draining during `approve` |
| ETH-088 | EIP-7702 Cross-Chain Authorization Replay | CRITICAL | — | Authorization tuple replayed on different chain without chain ID check |
| ETH-089 | EOA Code Assumption Failure | HIGH | — | `extcodesize == 0` no longer reliably identifies EOAs |

### Account Abstraction — ERC-4337 (ETH-090 to ETH-093)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-090 | UserOp Hash Collision | HIGH | — | Packed UserOp fields allow hash collision between different ops |
| ETH-091 | Paymaster Exploitation | CRITICAL | — | Paymaster validates user but not actual execution cost/effects |
| ETH-092 | Bundler Manipulation | HIGH | — | Bundler reorders/censors UserOps for MEV extraction |
| ETH-093 | Validation-Execution Phase Confusion | CRITICAL | — | Validation phase has side effects that affect execution phase |

### Modern DeFi (ETH-094 to ETH-097)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-094 | Uniswap V4 Hook Callback Authorization | CRITICAL | — | Hook doesn't verify `msg.sender == poolManager` |
| ETH-095 | Hook Data Manipulation | HIGH | — | Attacker passes crafted hookData to manipulate hook behavior |
| ETH-096 | Cached State Desynchronization | HIGH | — | Cached oracle/balance desyncs from actual state mid-transaction |
| ETH-097 | Known Compiler Bug in Used Version | HIGH | — | Contract compiled with Solidity version containing known bug |

### Input Validation — OWASP 2025 #4 (ETH-098 to ETH-099)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-098 | Missing Input Validation / Boundary Check | HIGH | — | Function parameters not validated (zero, overflow, out-of-range) |
| ETH-099 | Unsafe ABI Decoding / Calldata Manipulation | HIGH | — | Raw `abi.decode` without length/type validation on external input |

### Off-Chain & Infrastructure (ETH-100 to ETH-101)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-100 | EIP-7702 Delegation Phishing | CRITICAL | — | EOA tricked into signing delegation tuple to malicious contract code |
| ETH-101 | Off-Chain Infrastructure Compromise | CRITICAL | — | Frontend/signer/UI supply chain attack enabling malicious transactions (Bybit pattern) |

### Restaking & L2 (ETH-102 to ETH-104)
| ID | Pattern | Severity | SWC | Detection |
|----|---------|----------|-----|-----------|
| ETH-102 | Restaking Cascading Slashing Risk | HIGH | — | EigenLayer-style restaking where slashing in one AVS compounds across others |
| ETH-103 | L2 Sequencer Dependency | HIGH | — | Protocol relies on L2 sequencer uptime without fallback; stale data during downtime |
| ETH-104 | L2 Cross-Domain Message Replay | CRITICAL | — | Bridge message replayed across L2s or after reorg without proper nonce/chain validation |
