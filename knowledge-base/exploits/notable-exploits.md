# Notable Smart Contract Exploits

## The DAO (2016) — $60M
- **Chain**: Ethereum
- **Pattern**: ETH-001 (Single-function Reentrancy)
- **Root Cause**: `withdraw()` sent ETH before updating balance
- **Attack**: Recursive call via fallback function drained funds
- **Lesson**: Checks-Effects-Interactions pattern, ReentrancyGuard

## Parity Multisig Wallet (2017) — $280M Frozen
- **Chain**: Ethereum
- **Pattern**: ETH-049 (Uninitialized Implementation)
- **Root Cause**: Library contract left uninitialized, anyone could call `initWallet()`
- **Attack**: Attacker initialized library, called `kill()` — froze all dependent wallets
- **Lesson**: Always initialize implementation contracts, `_disableInitializers()`

## Ronin Bridge (2022) — $625M
- **Chain**: Ronin/Ethereum
- **Pattern**: ETH-006 (Missing Access Control)
- **Root Cause**: 5/9 validator keys compromised, threshold too low
- **Attack**: Social engineering to obtain keys, forged withdrawal signatures
- **Lesson**: High-security multisig thresholds, hardware key management

## Wormhole Bridge (2022) — $326M
- **Chain**: Solana/Ethereum
- **Pattern**: ETH-006 (Missing Validation)
- **Root Cause**: Missing signature verification on guardian set
- **Attack**: Forged guardian signatures to mint wrapped tokens
- **Lesson**: Always verify all signatures, never trust unverified inputs

## Beanstalk (2022) — $182M
- **Chain**: Ethereum
- **Pattern**: ETH-025 + ETH-055 (Flash Loan + Governance)
- **Root Cause**: Flash-loan funded governance proposal with immediate execution
- **Attack**: Borrowed tokens, voted, executed malicious proposal in one tx
- **Lesson**: Snapshot voting, timelock on execution, flash loan protection

## Euler Finance (2023) — $197M
- **Chain**: Ethereum
- **Pattern**: ETH-058 (Donation Attack)
- **Root Cause**: eToken donation allowed share price manipulation
- **Attack**: Donated tokens to inflate share price, exploited liquidation logic
- **Lesson**: Independent asset tracking, donation attack mitigation

## Cream Finance (2021) — $130M
- **Chain**: Ethereum
- **Pattern**: ETH-024 (Oracle Manipulation)
- **Root Cause**: Price oracle based on AMM spot price
- **Attack**: Flash loan to manipulate oracle, over-borrow against inflated collateral
- **Lesson**: TWAP, multi-source oracles, Chainlink

## Nomad Bridge (2022) — $190M
- **Chain**: Ethereum
- **Pattern**: ETH-029 (Uninitialized Storage)
- **Root Cause**: Upgrade left `confirmAt[root]` as zero, zero was valid
- **Attack**: Anyone could prove arbitrary messages as valid
- **Lesson**: Never treat zero as valid confirmation, test upgrade paths

## BNB Bridge (2022) — $570M
- **Chain**: BNB Chain
- **Pattern**: ETH-038 (Signature Verification)
- **Root Cause**: IAVL proof verification flaw
- **Attack**: Forged proof to mint BNB tokens
- **Lesson**: Thorough cryptographic verification testing

## Harvest Finance (2020) — $34M
- **Chain**: Ethereum
- **Pattern**: ETH-024 + ETH-025 (Flash Loan Oracle)
- **Root Cause**: Vault used Curve pool spot price as oracle
- **Attack**: Flash loan to skew Curve pool, deposit at favorable rate
- **Lesson**: TWAP for oracle, flash loan resistant pricing

## Indexed Finance (2021) — $16M
- **Chain**: Ethereum
- **Pattern**: ETH-059 (AMM Logic Error)
- **Root Cause**: Index rebalancing formula could be manipulated
- **Attack**: Manipulated token weights during rebalance
- **Lesson**: Formal verification of AMM invariants

## Rari Capital / Fei (2022) — $80M
- **Chain**: Ethereum
- **Pattern**: ETH-001 (Reentrancy)
- **Root Cause**: Missing reentrancy guard on borrow function
- **Attack**: Reentrant call during borrow to inflate balance
- **Lesson**: nonReentrant on ALL state-changing functions

## BadgerDAO (2021) — $120M
- **Chain**: Ethereum
- **Pattern**: ETH-006 (Access Control — Front-end)
- **Root Cause**: Compromised Cloudflare API key injected malicious approvals
- **Attack**: Front-end injected approval transactions users signed
- **Lesson**: On-chain governance, front-end security, approval monitoring

---

## 2025-2026 Exploits

## SIR.trading (2025) — $355K
- **Chain**: Ethereum
- **Pattern**: ETH-081 (Transient Storage Slot Collision)
- **Root Cause**: Two contracts using same transient storage slot via delegatecall; first use of TSTORE in production exploit
- **Attack**: Attacker triggered delegatecall path where caller's transient slot was overwritten by callee's TSTORE, corrupting reentrancy guard state
- **Lesson**: Transient storage slots must be namespaced per contract; EIP-1153 reentrancy guards need same isolation as storage-based guards

## Cork Protocol (2025) — $11M
- **Chain**: Ethereum
- **Pattern**: ETH-094 (Uniswap V4 Hook Callback Authorization)
- **Root Cause**: Hook contract did not verify `msg.sender == poolManager` in callback, allowing arbitrary callers to trigger hook logic
- **Attack**: Attacker directly called hook's `afterSwap` callback with crafted parameters to manipulate pool state and drain funds
- **Lesson**: All Uniswap V4 hook callbacks must validate `msg.sender` is the PoolManager; never assume only PoolManager calls hooks

## Yearn yETH (2025) — $9M
- **Chain**: Ethereum
- **Pattern**: ETH-096 (Cached State Desynchronization)
- **Root Cause**: Oracle price was cached at start of multi-step transaction, then actual underlying balance changed mid-tx via donation + flash loan
- **Attack**: Flash loan → donate tokens to vault → vault recalculates shares with inflated totalAssets but cached price → extract profit
- **Lesson**: Re-read state after any external interaction; never cache values across untrusted external calls

## Balancer V2 Read-Only Reentrancy (2025) — $128M at risk
- **Chain**: Ethereum
- **Pattern**: ETH-004 (Read-only Reentrancy)
- **Root Cause**: `getRate()` view function returned stale value during callback in `joinPool()`, exploitable by external protocols using the rate
- **Attack**: Enter pool → callback during join → external protocol reads manipulated rate → borrow against inflated collateral
- **Lesson**: View functions must account for reentrancy state; use reentrancy-aware oracles or check reentrancy lock status

## GMX V1 Price Manipulation (2025) — $42M
- **Chain**: Arbitrum
- **Pattern**: ETH-024 (Oracle Manipulation)
- **Root Cause**: Fast oracle with low latency allowed front-running of price updates; single-source Chainlink feed without TWAP
- **Attack**: Monitor Chainlink price feed → submit trade before price update tx → profit from stale price → repeat
- **Lesson**: Use multi-oracle with TWAP; add execution delay or commit-reveal for large trades

## Radiant Capital (2024) — $50M
- **Chain**: Arbitrum / BNB Chain
- **Pattern**: ETH-006 (Missing Access Control) + ETH-038 (Signature)
- **Root Cause**: Compromised 3/11 multisig keys via malware on signer devices
- **Attack**: Obtained private keys, submitted malicious transactions through multisig with just 3 signatures
- **Lesson**: Higher multisig thresholds (6/11+), hardware wallets mandatory, transaction simulation before signing

## Munchables (2024) — $62.5M
- **Chain**: Blast L2
- **Pattern**: ETH-006 (Missing Access Control)
- **Root Cause**: Insider threat — developer retained admin keys and drained protocol
- **Attack**: Deployed contract with hidden admin key, later used it to drain all locked ETH
- **Lesson**: Multi-party deployment, ownership transfer to multisig immediately, time-locked admin functions

## Bybit (2025) — $1.5B
- **Chain**: Ethereum
- **Pattern**: ETH-101 (Off-Chain Infrastructure Compromise)
- **Root Cause**: Safe{Wallet} frontend UI was compromised, injecting malicious delegatecall transaction into multisig signing flow
- **Attack**: Attacker compromised Safe{Wallet} web interface → injected transaction that used delegatecall to transfer control of Bybit's cold wallet → drained $1.5B in ETH
- **Lesson**: Largest crypto hack ever. Verify transaction calldata independently of UI. Use hardware wallet displays for transaction verification. Multi-party transaction simulation before signing. Don't trust frontend UIs for high-value transactions.
- **Note**: Off-chain attacks accounted for 80.5% of stolen funds in 2025

## UPCX (2025) — $70M
- **Chain**: Ethereum
- **Pattern**: ETH-052 (Missing Upgrade Authorization)
- **Root Cause**: Unauthorized contract upgrade allowed attacker to replace implementation with malicious code
- **Attack**: Exploited upgrade mechanism to deploy malicious implementation → drained protocol funds
- **Lesson**: Upgrades must require timelock + multisig. Use OpenZeppelin's UUPS with `_authorizeUpgrade()`. Monitor for unexpected proxy implementation changes.

## Phemex (2025) — $73M
- **Chain**: Ethereum / Multi-chain
- **Pattern**: ETH-006 (Missing Access Control)
- **Root Cause**: Hot wallet private key compromised
- **Attack**: Attacker obtained hot wallet keys → drained funds across multiple chains
- **Lesson**: Limit hot wallet balances. Use threshold signatures. Monitor for unusual withdrawal patterns. Cold storage for majority of funds.

## Meta Pool (2025) — $27M
- **Chain**: NEAR / Aurora
- **Pattern**: ETH-048 (Token Supply Manipulation)
- **Root Cause**: Minting bug in liquid staking derivative contract allowed unauthorized token creation
- **Attack**: Exploited minting logic to create unbacked staking derivative tokens → sold on market
- **Lesson**: Strict minting controls with rate limits. Invariant: total minted <= total staked. Multi-oracle verification for staking state.

## Balancer V2 Rounding Exploit (2025) — $128M at risk
- **Chain**: Ethereum
- **Pattern**: ETH-016 (Rounding Errors) + ETH-004 (Read-only Reentrancy)
- **Root Cause**: Rounding error in `_upscaleArray` function accumulated over 65 micro-swap transactions to create meaningful price discrepancy
- **Attack**: Execute 65 small swaps → each swap introduces tiny rounding error in token scaling → accumulated error creates exploitable price difference → drain via arbitrage
- **Lesson**: Use `mulDivUp`/`mulDivDown` consistently. Test with micro-transactions. Formal verification of rounding behavior. Balancer patched before full exploitation.
